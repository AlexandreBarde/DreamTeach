!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@fullcalendar/core")):"function"==typeof define&&define.amd?define(["exports","@fullcalendar/core"],t):t((e=e||self).FullCalendarInteraction={},e.FullCalendar)}(this,function(e,f){"use strict";var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function a(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var E=function(){return(E=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};f.config.touchMouseIgnoreWait=500;var n=0,t=0,i=!1,o=function(){function e(e){var r=this;this.subjectEl=null,this.downEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=function(e){if(!r.shouldIgnoreMouse()&&(0===(n=e).button&&!n.ctrlKey)&&r.tryStart(e)){var t=r.createEventFromMouse(e,!0);r.emitter.trigger("pointerdown",t),r.initScrollWatch(t),r.shouldIgnoreMove||document.addEventListener("mousemove",r.handleMouseMove),document.addEventListener("mouseup",r.handleMouseUp)}var n},this.handleMouseMove=function(e){var t=r.createEventFromMouse(e);r.recordCoords(t),r.emitter.trigger("pointermove",t)},this.handleMouseUp=function(e){document.removeEventListener("mousemove",r.handleMouseMove),document.removeEventListener("mouseup",r.handleMouseUp),r.emitter.trigger("pointerup",r.createEventFromMouse(e)),r.cleanup()},this.handleTouchStart=function(e){if(r.tryStart(e)){r.isTouchDragging=!0;var t=r.createEventFromTouch(e,!0);r.emitter.trigger("pointerdown",t),r.initScrollWatch(t);var n=e.target;r.shouldIgnoreMove||n.addEventListener("touchmove",r.handleTouchMove),n.addEventListener("touchend",r.handleTouchEnd),n.addEventListener("touchcancel",r.handleTouchEnd),window.addEventListener("scroll",r.handleTouchScroll,!0)}},this.handleTouchMove=function(e){var t=r.createEventFromTouch(e);r.recordCoords(t),r.emitter.trigger("pointermove",t)},this.handleTouchEnd=function(e){if(r.isDragging){var t=e.target;t.removeEventListener("touchmove",r.handleTouchMove),t.removeEventListener("touchend",r.handleTouchEnd),t.removeEventListener("touchcancel",r.handleTouchEnd),window.removeEventListener("scroll",r.handleTouchScroll,!0),r.emitter.trigger("pointerup",r.createEventFromTouch(e)),r.cleanup(),r.isTouchDragging=!1,n++,setTimeout(function(){n--},f.config.touchMouseIgnoreWait)}},this.handleTouchScroll=function(){r.wasTouchScroll=!0},this.handleScroll=function(e){if(!r.shouldIgnoreMove){var t=window.pageXOffset-r.prevScrollX+r.prevPageX,n=window.pageYOffset-r.prevScrollY+r.prevPageY;r.emitter.trigger("pointermove",{origEvent:e,isTouch:r.isTouchDragging,subjectEl:r.subjectEl,pageX:t,pageY:n,deltaX:t-r.origPageX,deltaY:n-r.origPageY})}},this.containerEl=e,this.emitter=new f.EmitterMixin,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),t++||window.addEventListener("touchmove",l,{passive:!1})}return e.prototype.destroy=function(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),--t||window.removeEventListener("touchmove",l,{passive:!1})},e.prototype.tryStart=function(e){var t=this.querySubjectEl(e),n=e.target;return!(!t||this.handleSelector&&!f.elementClosest(n,this.handleSelector))&&(this.subjectEl=t,this.downEl=n,this.isDragging=!0,!(this.wasTouchScroll=!1))},e.prototype.cleanup=function(){i=!1,this.isDragging=!1,this.subjectEl=null,this.downEl=null,this.destroyScrollWatch()},e.prototype.querySubjectEl=function(e){return this.selector?f.elementClosest(e.target,this.selector):this.containerEl},e.prototype.shouldIgnoreMouse=function(){return n||this.isTouchDragging},e.prototype.cancelTouchScroll=function(){this.isDragging&&(i=!0)},e.prototype.initScrollWatch=function(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))},e.prototype.recordCoords=function(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.pageXOffset,this.prevScrollY=window.pageYOffset)},e.prototype.destroyScrollWatch=function(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)},e.prototype.createEventFromMouse=function(e,t){var n=0,r=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(n=e.pageX-this.origPageX,r=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:n,deltaY:r}},e.prototype.createEventFromTouch=function(e,t){var n,r,i=e.touches,o=0,a=0;return r=i&&i.length?(n=i[0].pageX,i[0].pageY):(n=e.pageX,e.pageY),t?(this.origPageX=n,this.origPageY=r):(o=n-this.origPageX,a=r-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:n,pageY:r,deltaX:o,deltaY:a}},e}();function l(e){i&&e.preventDefault()}var s=function(){function e(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}return e.prototype.start=function(e,t,n){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.pageXOffset,this.origScreenY=n-window.pageYOffset,this.deltaX=0,this.deltaY=0,this.updateElPosition()},e.prototype.handleMove=function(e,t){this.deltaX=e-window.pageXOffset-this.origScreenX,this.deltaY=t-window.pageYOffset-this.origScreenY,this.updateElPosition()},e.prototype.setIsVisible=function(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)},e.prototype.stop=function(e,t){var n=this,r=function(){n.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(r,this.revertDuration):setTimeout(r,0)},e.prototype.doRevertAnimation=function(e,t){var n=this.mirrorEl,r=this.sourceEl.getBoundingClientRect();n.style.transition="top "+t+"ms,left "+t+"ms",f.applyStyle(n,{left:r.left,top:r.top}),f.whenTransitionDone(n,function(){n.style.transition="",e()})},e.prototype.cleanup=function(){this.mirrorEl&&(f.removeElement(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null},e.prototype.updateElPosition=function(){this.sourceEl&&this.isVisible&&f.applyStyle(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})},e.prototype.getMirrorEl=function(){var e=this.sourceElRect,t=this.mirrorEl;return t||((t=this.mirrorEl=this.sourceEl.cloneNode(!0)).classList.add("fc-unselectable"),t.classList.add("fc-dragging"),f.applyStyle(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t},e}(),c=function(r){function e(e,t){var n=r.call(this)||this;return n.handleScroll=function(){n.scrollTop=n.scrollController.getScrollTop(),n.scrollLeft=n.scrollController.getScrollLeft(),n.handleScrollChange()},n.scrollController=e,n.doesListening=t,n.scrollTop=n.origScrollTop=e.getScrollTop(),n.scrollLeft=n.origScrollLeft=e.getScrollLeft(),n.scrollWidth=e.getScrollWidth(),n.scrollHeight=e.getScrollHeight(),n.clientWidth=e.getClientWidth(),n.clientHeight=e.getClientHeight(),n.clientRect=n.computeClientRect(),n.doesListening&&n.getEventTarget().addEventListener("scroll",n.handleScroll),n}return a(e,r),e.prototype.destroy=function(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)},e.prototype.getScrollTop=function(){return this.scrollTop},e.prototype.getScrollLeft=function(){return this.scrollLeft},e.prototype.setScrollTop=function(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())},e.prototype.setScrollLeft=function(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())},e.prototype.getClientWidth=function(){return this.clientWidth},e.prototype.getClientHeight=function(){return this.clientHeight},e.prototype.getScrollWidth=function(){return this.scrollWidth},e.prototype.getScrollHeight=function(){return this.scrollHeight},e.prototype.handleScrollChange=function(){},e}(f.ScrollController),d=function(n){function e(e,t){return n.call(this,new f.ElementScrollController(e),t)||this}return a(e,n),e.prototype.getEventTarget=function(){return this.scrollController.el},e.prototype.computeClientRect=function(){return f.computeInnerRect(this.scrollController.el)},e}(c),g=function(t){function e(e){return t.call(this,new f.WindowScrollController,e)||this}return a(e,t),e.prototype.getEventTarget=function(){return window},e.prototype.computeClientRect=function(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}},e.prototype.handleScrollChange=function(){this.clientRect=this.computeClientRect()},e}(c),u="function"==typeof performance?performance.now:Date.now,h=function(){function e(){var n=this;this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=function(){if(n.isAnimating){var e=n.computeBestEdge(n.pointerScreenX+window.pageXOffset,n.pointerScreenY+window.pageYOffset);if(e){var t=u();n.handleSide(e,(t-n.msSinceRequest)/1e3),n.requestAnimation(t)}else n.isAnimating=!1}}}return e.prototype.start=function(e,t){this.isEnabled&&(this.scrollCaches=this.buildCaches(),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))},e.prototype.handleMove=function(e,t){if(this.isEnabled){var n=e-window.pageXOffset,r=t-window.pageYOffset,i=null===this.pointerScreenY?0:r-this.pointerScreenY,o=null===this.pointerScreenX?0:n-this.pointerScreenX;i<0?this.everMovedUp=!0:0<i&&(this.everMovedDown=!0),o<0?this.everMovedLeft=!0:0<o&&(this.everMovedRight=!0),this.pointerScreenX=n,this.pointerScreenY=r,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(u()))}},e.prototype.stop=function(){if(this.isEnabled){this.isAnimating=!1;for(var e=0,t=this.scrollCaches;e<t.length;e++){t[e].destroy()}this.scrollCaches=null}},e.prototype.requestAnimation=function(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)},e.prototype.handleSide=function(e,t){var n=e.scrollCache,r=this.edgeThreshold,i=r-e.distance,o=i*i/(r*r)*this.maxVelocity*t,a=1;switch(e.name){case"left":a=-1;case"right":n.setScrollLeft(n.getScrollLeft()+o*a);break;case"top":a=-1;case"bottom":n.setScrollTop(n.getScrollTop()+o*a)}},e.prototype.computeBestEdge=function(e,t){for(var n=this.edgeThreshold,r=null,i=0,o=this.scrollCaches;i<o.length;i++){var a=o[i],l=a.clientRect,s=e-l.left,c=l.right-e,d=t-l.top,g=l.bottom-t;0<=s&&0<=c&&0<=d&&0<=g&&(d<=n&&this.everMovedUp&&a.canScrollUp()&&(!r||r.distance>d)&&(r={scrollCache:a,name:"top",distance:d}),g<=n&&this.everMovedDown&&a.canScrollDown()&&(!r||r.distance>g)&&(r={scrollCache:a,name:"bottom",distance:g}),s<=n&&this.everMovedLeft&&a.canScrollLeft()&&(!r||r.distance>s)&&(r={scrollCache:a,name:"left",distance:s}),c<=n&&this.everMovedRight&&a.canScrollRight()&&(!r||r.distance>c)&&(r={scrollCache:a,name:"right",distance:c}))}return r},e.prototype.buildCaches=function(){return this.queryScrollEls().map(function(e){return e===window?new g(!1):new d(e,!1)})},e.prototype.queryScrollEls=function(){for(var e=[],t=0,n=this.scrollQuery;t<n.length;t++){var r=n[t];"object"==typeof r?e.push(r):e.push.apply(e,Array.prototype.slice.call(document.querySelectorAll(r)))}return e},e}(),p=function(n){function e(e){var i=n.call(this,e)||this;i.delay=null,i.minDistance=0,i.touchScrollAllowed=!0,i.mirrorNeedsRevert=!1,i.isInteracting=!1,i.isDragging=!1,i.isDelayEnded=!1,i.isDistanceSurpassed=!1,i.delayTimeoutId=null,i.onPointerDown=function(e){i.isDragging||(i.isInteracting=!0,i.isDelayEnded=!1,i.isDistanceSurpassed=!1,f.preventSelection(document.body),f.preventContextMenu(document.body),e.isTouch||e.origEvent.preventDefault(),i.emitter.trigger("pointerdown",e),i.pointer.shouldIgnoreMove||(i.mirror.setIsVisible(!1),i.mirror.start(e.subjectEl,e.pageX,e.pageY),i.startDelay(e),i.minDistance||i.handleDistanceSurpassed(e)))},i.onPointerMove=function(e){if(i.isInteracting){if(i.emitter.trigger("pointermove",e),!i.isDistanceSurpassed){var t=i.minDistance,n=e.deltaX,r=e.deltaY;t*t<=n*n+r*r&&i.handleDistanceSurpassed(e)}i.isDragging&&("scroll"!==e.origEvent.type&&(i.mirror.handleMove(e.pageX,e.pageY),i.autoScroller.handleMove(e.pageX,e.pageY)),i.emitter.trigger("dragmove",e))}},i.onPointerUp=function(e){i.isInteracting&&(i.isInteracting=!1,f.allowSelection(document.body),f.allowContextMenu(document.body),i.emitter.trigger("pointerup",e),i.isDragging&&(i.autoScroller.stop(),i.tryStopDrag(e)),i.delayTimeoutId&&(clearTimeout(i.delayTimeoutId),i.delayTimeoutId=null))};var t=i.pointer=new o(e);return t.emitter.on("pointerdown",i.onPointerDown),t.emitter.on("pointermove",i.onPointerMove),t.emitter.on("pointerup",i.onPointerUp),i.mirror=new s,i.autoScroller=new h,i}return a(e,n),e.prototype.destroy=function(){this.pointer.destroy()},e.prototype.startDelay=function(e){var t=this;"number"==typeof this.delay?this.delayTimeoutId=setTimeout(function(){t.delayTimeoutId=null,t.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)},e.prototype.handleDelayEnd=function(e){this.isDelayEnded=!0,this.tryStartDrag(e)},e.prototype.handleDistanceSurpassed=function(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)},e.prototype.tryStartDrag=function(e){this.isDelayEnded&&this.isDistanceSurpassed&&(this.pointer.wasTouchScroll&&!this.touchScrollAllowed||(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY),this.emitter.trigger("dragstart",e),!1===this.touchScrollAllowed&&this.pointer.cancelTouchScroll()))},e.prototype.tryStopDrag=function(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))},e.prototype.stopDrag=function(e){this.isDragging=!1,this.emitter.trigger("dragend",e)},e.prototype.setIgnoreMove=function(e){this.pointer.shouldIgnoreMove=e},e.prototype.setMirrorIsVisible=function(e){this.mirror.setIsVisible(e)},e.prototype.setMirrorNeedsRevert=function(e){this.mirrorNeedsRevert=e},e.prototype.setAutoScrollEnabled=function(e){this.autoScroller.isEnabled=e},e}(f.ElementDragging),v=function(){function e(e){this.origRect=f.computeRect(e),this.scrollCaches=f.getClippingParents(e).map(function(e){return new d(e,!0)})}return e.prototype.destroy=function(){for(var e=0,t=this.scrollCaches;e<t.length;e++){t[e].destroy()}},e.prototype.computeLeft=function(){for(var e=this.origRect.left,t=0,n=this.scrollCaches;t<n.length;t++){var r=n[t];e+=r.origScrollLeft-r.getScrollLeft()}return e},e.prototype.computeTop=function(){for(var e=this.origRect.top,t=0,n=this.scrollCaches;t<n.length;t++){var r=n[t];e+=r.origScrollTop-r.getScrollTop()}return e},e.prototype.isWithinClipping=function(e,t){for(var n,r,i={left:e,top:t},o=0,a=this.scrollCaches;o<a.length;o++){var l=a[o];if(n=l.getEventTarget(),void 0,"HTML"!==(r=n.tagName)&&"BODY"!==r&&!f.pointInsideRect(i,l.clientRect))return!1}return!0},e}();var m=function(){function e(e,t){var n=this;this.useSubjectCenter=!1,this.requireInitial=!0,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=function(e){var t=n.dragging;n.initialHit=null,n.movingHit=null,n.finalHit=null,n.prepareHits(),n.processFirstCoord(e),n.initialHit||!n.requireInitial?(t.setIgnoreMove(!1),n.emitter.trigger("pointerdown",e)):t.setIgnoreMove(!0)},this.handleDragStart=function(e){n.emitter.trigger("dragstart",e),n.handleMove(e,!0)},this.handleDragMove=function(e){n.emitter.trigger("dragmove",e),n.handleMove(e)},this.handlePointerUp=function(e){n.releaseHits(),n.emitter.trigger("pointerup",e)},this.handleDragEnd=function(e){n.movingHit&&n.emitter.trigger("hitupdate",null,!0,e),n.finalHit=n.movingHit,n.movingHit=null,n.emitter.trigger("dragend",e)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new f.EmitterMixin}return e.prototype.processFirstCoord=function(e){var t,n={left:e.pageX,top:e.pageY},r=n,i=e.subjectEl;i!==document&&(t=f.computeRect(i),r=f.constrainPoint(r,t));var o=this.initialHit=this.queryHitForOffset(r.left,r.top);if(o){if(this.useSubjectCenter&&t){var a=f.intersectRects(t,o.rect);a&&(r=f.getRectCenter(a))}this.coordAdjust=f.diffPoints(r,n)}else this.coordAdjust={left:0,top:0}},e.prototype.handleMove=function(e,t){var n=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);!t&&S(this.movingHit,n)||(this.movingHit=n,this.emitter.trigger("hitupdate",n,!1,e))},e.prototype.prepareHits=function(){this.offsetTrackers=f.mapHash(this.droppableStore,function(e){return new v(e.el)})},e.prototype.releaseHits=function(){var e=this.offsetTrackers;for(var t in e)e[t].destroy();this.offsetTrackers={}},e.prototype.queryHitForOffset=function(e,t){var n=this.droppableStore,r=this.offsetTrackers,i=null;for(var o in n){var a=n[o].component,l=r[o];if(l.isWithinClipping(e,t)){var s=l.computeLeft(),c=l.computeTop(),d=e-s,g=t-c,u=l.origRect,h=u.right-u.left,p=u.bottom-u.top;if(0<=d&&d<h&&0<=g&&g<p){var v=a.queryHit(d,g,h,p);!v||a.props.dateProfile&&!f.rangeContainsRange(a.props.dateProfile.activeRange,v.dateSpan.range)||i&&!(v.layer>i.layer)||(v.rect.left+=s,v.rect.right+=s,v.rect.top+=c,v.rect.bottom+=c,i=v)}}}return i},e}();function S(e,t){return!e&&!t||Boolean(e)===Boolean(t)&&f.isDateSpansEqual(e.dateSpan,t.dateSpan)}var y=function(r){function e(e){var o=r.call(this,e)||this;o.handlePointerDown=function(e){var t=o.dragging;t.setIgnoreMove(!o.component.isValidDateDownEl(t.pointer.downEl))},o.handleDragEnd=function(e){var t=o.component;if(!o.dragging.pointer.wasTouchScroll){var n=o.hitDragging,r=n.initialHit,i=n.finalHit;r&&i&&S(r,i)&&t.calendar.triggerDateClick(r.dateSpan,r.dayEl,t.view,e.origEvent)}};var t=e.component;o.dragging=new p(t.el),o.dragging.autoScroller.isEnabled=!1;var n=o.hitDragging=new m(o.dragging,f.interactionSettingsToStore(e));return n.emitter.on("pointerdown",o.handlePointerDown),n.emitter.on("dragend",o.handleDragEnd),o}return a(e,r),e.prototype.destroy=function(){this.dragging.destroy()},e}(f.Interaction),D=function(i){function e(e){var o=i.call(this,e)||this;o.dragSelection=null,o.handlePointerDown=function(e){var t=o,n=t.component,r=t.dragging,i=n.opt("selectable")&&n.isValidDateDownEl(e.origEvent.target);r.setIgnoreMove(!i),r.delay=e.isTouch?function(e){var t=e.opt("selectLongPressDelay");null==t&&(t=e.opt("longPressDelay"));return t}(n):null},o.handleDragStart=function(e){o.component.calendar.unselect(e)},o.handleHitUpdate=function(e,t){var n=o.component.calendar,r=null,i=!1;e&&((r=function(e,t,n){var r=e.dateSpan,i=t.dateSpan,o=[r.range.start,r.range.end,i.range.start,i.range.end];o.sort(f.compareNumbers);for(var a={},l=0,s=n;l<s.length;l++){var c=s[l],d=c(e,t);if(!1===d)return null;d&&E(a,d)}return a.range={start:o[0],end:o[3]},a.allDay=r.allDay,a}(o.hitDragging.initialHit,e,n.pluginSystem.hooks.dateSelectionTransformers))&&o.component.isDateSelectionValid(r)||(i=!0,r=null)),r?n.dispatch({type:"SELECT_DATES",selection:r}):t||n.dispatch({type:"UNSELECT_DATES"}),i?f.disableCursor():f.enableCursor(),t||(o.dragSelection=r)},o.handlePointerUp=function(e){o.dragSelection&&(o.component.calendar.triggerDateSelect(o.dragSelection,e),o.dragSelection=null)};var t=e.component,n=o.dragging=new p(t.el);n.touchScrollAllowed=!1,n.minDistance=t.opt("selectMinDistance")||0,n.autoScroller.isEnabled=t.opt("dragScroll");var r=o.hitDragging=new m(o.dragging,f.interactionSettingsToStore(e));return r.emitter.on("pointerdown",o.handlePointerDown),r.emitter.on("dragstart",o.handleDragStart),r.emitter.on("hitupdate",o.handleHitUpdate),r.emitter.on("pointerup",o.handlePointerUp),o}return a(e,i),e.prototype.destroy=function(){this.dragging.destroy()},e}(f.Interaction);var w=function(i){function o(e){var v=i.call(this,e)||this;v.subjectSeg=null,v.isDragging=!1,v.eventRange=null,v.relevantEvents=null,v.receivingCalendar=null,v.validMutation=null,v.mutatedRelevantEvents=null,v.handlePointerDown=function(e){var t=e.origEvent.target,n=v,r=n.component,i=n.dragging,o=i.mirror,a=r.calendar,l=v.subjectSeg=f.getElSeg(e.subjectEl),s=(v.eventRange=l.eventRange).instance.instanceId;v.relevantEvents=f.getRelevantEvents(a.state.eventStore,s),i.minDistance=e.isTouch?0:r.opt("eventDragMinDistance"),i.delay=e.isTouch&&s!==r.props.eventSelection?function(e){var t=e.opt("eventLongPressDelay");null==t&&(t=e.opt("longPressDelay"));return t}(r):null,o.parentNode=a.el,o.revertDuration=r.opt("dragRevertDuration");var c=r.isValidSegDownEl(t)&&!f.elementClosest(t,".fc-resizer");i.setIgnoreMove(!c),v.isDragging=c&&e.subjectEl.classList.contains("fc-draggable")},v.handleDragStart=function(e){var t=v.component.calendar,n=v.eventRange,r=n.instance.instanceId;e.isTouch?r!==v.component.props.eventSelection&&t.dispatch({type:"SELECT_EVENT",eventInstanceId:r}):t.dispatch({type:"UNSELECT_EVENT"}),v.isDragging&&(t.unselect(e),t.publiclyTrigger("eventDragStart",[{el:v.subjectSeg.el,event:new f.EventApi(t,n.def,n.instance),jsEvent:e.origEvent,view:v.component.view}]))},v.handleHitUpdate=function(e,t){if(v.isDragging){var n=v.relevantEvents,r=v.hitDragging.initialHit,i=v.component.calendar,o=null,a=null,l=null,s=!1,c={affectedEvents:n,mutatedEvents:f.createEmptyEventStore(),isEvent:!0,origSeg:v.subjectSeg};if(e){var d=e.component;i===(o=d.calendar)||d.opt("editable")&&d.opt("droppable")?(a=function(e,t,n){var r=e.dateSpan,i=t.dateSpan,o=r.range.start,a=i.range.start,l={};r.allDay!==i.allDay&&(l.allDay=i.allDay,l.hasEnd=t.component.opt("allDayMaintainDuration"),i.allDay&&(o=f.startOfDay(o)));var s=f.diffDates(o,a,e.component.dateEnv,e.component===t.component?e.component.largeUnit:null);s.milliseconds&&(l.allDay=!1);for(var c={startDelta:s,endDelta:s,standardProps:l},d=0,g=n;d<g.length;d++){var u=g[d];u(c,e,t)}return c}(r,e,o.pluginSystem.hooks.eventDragMutationMassagers))&&(l=f.applyMutationToEventStore(n,o.eventUiBases,a,o),c.mutatedEvents=l,d.isInteractionValid(c)||(s=!0,l=a=null,c.mutatedEvents=f.createEmptyEventStore())):o=null}v.displayDrag(o,c),s?f.disableCursor():f.enableCursor(),t||(i===o&&S(r,e)&&(a=null),v.dragging.setMirrorNeedsRevert(!a),v.dragging.setMirrorIsVisible(!e||!document.querySelector(".fc-mirror")),v.receivingCalendar=o,v.validMutation=a,v.mutatedRelevantEvents=l)}},v.handlePointerUp=function(){v.isDragging||v.cleanup()},v.handleDragEnd=function(e){if(v.isDragging){var t=v.component.calendar,n=v.component.view,r=v.receivingCalendar,i=v.eventRange.def,o=v.eventRange.instance,a=new f.EventApi(t,i,o),l=v.relevantEvents,s=v.mutatedRelevantEvents,c=v.hitDragging.finalHit;if(v.clearDrag(),t.publiclyTrigger("eventDragStop",[{el:v.subjectSeg.el,event:a,jsEvent:e.origEvent,view:n}]),v.validMutation){if(r===t){t.dispatch({type:"MERGE_EVENTS",eventStore:s});for(var d={},g=0,u=t.pluginSystem.hooks.eventDropTransformers;g<u.length;g++){var h=u[g];E(d,h(v.validMutation,t))}E(d,{el:e.subjectEl,delta:v.validMutation.startDelta,oldEvent:a,event:new f.EventApi(t,s.defs[i.defId],o?s.instances[o.instanceId]:null),revert:function(){t.dispatch({type:"MERGE_EVENTS",eventStore:l})},jsEvent:e.origEvent,view:n}),t.publiclyTrigger("eventDrop",[d])}else if(r){t.publiclyTrigger("eventLeave",[{draggedEl:e.subjectEl,event:a,view:n}]),t.dispatch({type:"REMOVE_EVENT_INSTANCES",instances:v.mutatedRelevantEvents.instances}),r.dispatch({type:"MERGE_EVENTS",eventStore:v.mutatedRelevantEvents}),e.isTouch&&r.dispatch({type:"SELECT_EVENT",eventInstanceId:o.instanceId});var p=r.buildDatePointApi(c.dateSpan);p.draggedEl=e.subjectEl,p.jsEvent=e.origEvent,p.view=c.component,r.publiclyTrigger("drop",[p]),r.publiclyTrigger("eventReceive",[{draggedEl:e.subjectEl,event:new f.EventApi(r,s.defs[i.defId],s.instances[o.instanceId]),view:c.component}])}}else t.publiclyTrigger("_noEventDrop")}v.cleanup()};var t=v.component,n=v.dragging=new p(t.el);n.pointer.selector=o.SELECTOR,n.touchScrollAllowed=!1,n.autoScroller.isEnabled=t.opt("dragScroll");var r=v.hitDragging=new m(v.dragging,f.interactionSettingsStore);return r.useSubjectCenter=e.useEventCenter,r.emitter.on("pointerdown",v.handlePointerDown),r.emitter.on("dragstart",v.handleDragStart),r.emitter.on("hitupdate",v.handleHitUpdate),r.emitter.on("pointerup",v.handlePointerUp),r.emitter.on("dragend",v.handleDragEnd),v}return a(o,i),o.prototype.destroy=function(){this.dragging.destroy()},o.prototype.displayDrag=function(e,t){var n=this.component.calendar,r=this.receivingCalendar;r&&r!==e&&(r===n?r.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:f.createEmptyEventStore(),isEvent:!0,origSeg:t.origSeg}}):r.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})},o.prototype.clearDrag=function(){var e=this.component.calendar,t=this.receivingCalendar;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})},o.prototype.cleanup=function(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingCalendar=null,this.validMutation=null,this.mutatedRelevantEvents=null},o.SELECTOR=".fc-draggable, .fc-resizable",o}(f.Interaction);var T=function(i){function e(e){var g=i.call(this,e)||this;g.draggingSeg=null,g.eventRange=null,g.relevantEvents=null,g.validMutation=null,g.mutatedRelevantEvents=null,g.handlePointerDown=function(e){var t=g.component,n=g.querySeg(e),r=g.eventRange=n.eventRange;g.dragging.minDistance=t.opt("eventDragMinDistance"),g.dragging.setIgnoreMove(!g.component.isValidSegDownEl(e.origEvent.target)||e.isTouch&&g.component.props.eventSelection!==r.instance.instanceId)},g.handleDragStart=function(e){var t=g.component.calendar,n=g.eventRange;g.relevantEvents=f.getRelevantEvents(t.state.eventStore,g.eventRange.instance.instanceId),g.draggingSeg=g.querySeg(e),t.unselect(),t.publiclyTrigger("eventResizeStart",[{el:g.draggingSeg.el,event:new f.EventApi(t,n.def,n.instance),jsEvent:e.origEvent,view:g.component.view}])},g.handleHitUpdate=function(e,t,n){var r=g.component.calendar,i=g.relevantEvents,o=g.hitDragging.initialHit,a=g.eventRange.instance,l=null,s=null,c=!1,d={affectedEvents:i,mutatedEvents:f.createEmptyEventStore(),isEvent:!0,origSeg:g.draggingSeg};e&&(l=function(e,t,n,r,i){for(var o=e.component.dateEnv,a=e.dateSpan.range.start,l=t.dateSpan.range.start,s=f.diffDates(a,l,o,e.component.largeUnit),c={},d=0,g=i;d<g.length;d++){var u=g[d],h=u(e,t);if(!1===h)return null;h&&E(c,h)}if(n){if(o.add(r.start,s)<r.end)return c.startDelta=s,c}else if(o.add(r.end,s)>r.start)return c.endDelta=s,c;return null}(o,e,n.subjectEl.classList.contains("fc-start-resizer"),a.range,r.pluginSystem.hooks.eventResizeJoinTransforms)),l&&(s=f.applyMutationToEventStore(i,r.eventUiBases,l,r),d.mutatedEvents=s,g.component.isInteractionValid(d)||(c=!0,s=l=null,d.mutatedEvents=null)),s?r.dispatch({type:"SET_EVENT_RESIZE",state:d}):r.dispatch({type:"UNSET_EVENT_RESIZE"}),c?f.disableCursor():f.enableCursor(),t||(l&&S(o,e)&&(l=null),g.validMutation=l,g.mutatedRelevantEvents=s)},g.handleDragEnd=function(e){var t=g.component.calendar,n=g.component.view,r=g.eventRange.def,i=g.eventRange.instance,o=new f.EventApi(t,r,i),a=g.relevantEvents,l=g.mutatedRelevantEvents;t.publiclyTrigger("eventResizeStop",[{el:g.draggingSeg.el,event:o,jsEvent:e.origEvent,view:n}]),g.validMutation?(t.dispatch({type:"MERGE_EVENTS",eventStore:l}),t.publiclyTrigger("eventResize",[{el:g.draggingSeg.el,startDelta:g.validMutation.startDelta||f.createDuration(0),endDelta:g.validMutation.endDelta||f.createDuration(0),prevEvent:o,event:new f.EventApi(t,l.defs[r.defId],i?l.instances[i.instanceId]:null),revert:function(){t.dispatch({type:"MERGE_EVENTS",eventStore:a})},jsEvent:e.origEvent,view:n}])):t.publiclyTrigger("_noEventResize"),g.draggingSeg=null,g.relevantEvents=null,g.validMutation=null};var t=e.component,n=g.dragging=new p(t.el);n.pointer.selector=".fc-resizer",n.touchScrollAllowed=!1,n.autoScroller.isEnabled=t.opt("dragScroll");var r=g.hitDragging=new m(g.dragging,f.interactionSettingsToStore(e));return r.emitter.on("pointerdown",g.handlePointerDown),r.emitter.on("dragstart",g.handleDragStart),r.emitter.on("hitupdate",g.handleHitUpdate),r.emitter.on("dragend",g.handleDragEnd),g}return a(e,i),e.prototype.destroy=function(){this.dragging.destroy()},e.prototype.querySeg=function(e){return f.getElSeg(f.elementClosest(e.subjectEl,this.component.fgSegSelector))},e}(f.Interaction);var M=function(){function e(e){var l=this;this.isRecentPointerDateSelect=!1,this.onSelect=function(e){e.jsEvent&&(l.isRecentPointerDateSelect=!0)},this.onDocumentPointerUp=function(e){var t=l,n=t.calendar,r=t.documentPointer,i=n.state;if(!r.wasTouchScroll){if(i.dateSelection&&!l.isRecentPointerDateSelect){var o=n.viewOpt("unselectAuto"),a=n.viewOpt("unselectCancel");!o||o&&f.elementClosest(r.downEl,a)||n.unselect(e)}i.eventSelection&&!f.elementClosest(r.downEl,w.SELECTOR)&&n.dispatch({type:"UNSELECT_EVENT"})}l.isRecentPointerDateSelect=!1},this.calendar=e;var t=this.documentPointer=new o(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerup",this.onDocumentPointerUp),e.on("select",this.onSelect)}return e.prototype.destroy=function(){this.calendar.off("select",this.onSelect),this.documentPointer.destroy()},e}(),b=function(){function e(e,t){var s=this;this.receivingCalendar=null,this.droppableEvent=null,this.suppliedDragMeta=null,this.dragMeta=null,this.handleDragStart=function(e){s.dragMeta=s.buildDragMeta(e.subjectEl)},this.handleHitUpdate=function(e,t,n){var r=s.hitDragging.dragging,i=null,o=null,a=!1,l={affectedEvents:f.createEmptyEventStore(),mutatedEvents:f.createEmptyEventStore(),isEvent:s.dragMeta.create,origSeg:null};e&&(i=e.component.calendar,s.canDropElOnCalendar(n.subjectEl,i)&&(o=function(e,t,n){for(var r=E({},t.leftoverProps),i=0,o=n.pluginSystem.hooks.externalDefTransforms;i<o.length;i++){var a=o[i];E(r,a(e,t))}var l=f.parseEventDef(r,t.sourceId,e.allDay,n.opt("forceEventDuration")||Boolean(t.duration),n),s=e.range.start;e.allDay&&t.startTime&&(s=n.dateEnv.add(s,t.startTime));var c=t.duration?n.dateEnv.add(s,t.duration):n.getDefaultEventEnd(e.allDay,s),d=f.createEventInstance(l.defId,{start:s,end:c});return{def:l,instance:d}}(e.dateSpan,s.dragMeta,i),l.mutatedEvents=f.eventTupleToStore(o),(a=!f.isInteractionValid(l,i))&&(l.mutatedEvents=f.createEmptyEventStore(),o=null))),s.displayDrag(i,l),r.setMirrorIsVisible(t||!o||!document.querySelector(".fc-mirror")),a?f.disableCursor():f.enableCursor(),t||(r.setMirrorNeedsRevert(!o),s.receivingCalendar=i,s.droppableEvent=o)},this.handleDragEnd=function(e){var t=s,n=t.receivingCalendar,r=t.droppableEvent;if(s.clearDrag(),n&&r){var i=s.hitDragging.finalHit,o=i.component.view,a=s.dragMeta,l=n.buildDatePointApi(i.dateSpan);l.draggedEl=e.subjectEl,l.jsEvent=e.origEvent,l.view=o,n.publiclyTrigger("drop",[l]),a.create&&(n.dispatch({type:"MERGE_EVENTS",eventStore:f.eventTupleToStore(r)}),e.isTouch&&n.dispatch({type:"SELECT_EVENT",eventInstanceId:r.instance.instanceId}),n.publiclyTrigger("eventReceive",[{draggedEl:e.subjectEl,event:new f.EventApi(n,r.def,r.instance),view:o}]))}s.receivingCalendar=null,s.droppableEvent=null};var n=this.hitDragging=new m(e,f.interactionSettingsStore);n.requireInitial=!1,n.emitter.on("dragstart",this.handleDragStart),n.emitter.on("hitupdate",this.handleHitUpdate),n.emitter.on("dragend",this.handleDragEnd),this.suppliedDragMeta=t}return e.prototype.buildDragMeta=function(e){return"object"==typeof this.suppliedDragMeta?f.parseDragMeta(this.suppliedDragMeta):"function"==typeof this.suppliedDragMeta?f.parseDragMeta(this.suppliedDragMeta(e)):(r=e,i="event",o=f.config.dataAttrPrefix,a=(o?o+"-":"")+i,t=r.getAttribute("data-"+a)||"",n=t?JSON.parse(t):{create:!1},f.parseDragMeta(n));var t,n,r,i,o,a},e.prototype.displayDrag=function(e,t){var n=this.receivingCalendar;n&&n!==e&&n.dispatch({type:"UNSET_EVENT_DRAG"}),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})},e.prototype.clearDrag=function(){this.receivingCalendar&&this.receivingCalendar.dispatch({type:"UNSET_EVENT_DRAG"})},e.prototype.canDropElOnCalendar=function(e,t){var n=t.opt("dropAccept");return"function"==typeof n?n(e):"string"!=typeof n||!n||Boolean(f.elementMatches(e,n))},e}();f.config.dataAttrPrefix="";var C=function(){function e(e,t){var o=this;void 0===t&&(t={}),this.handlePointerDown=function(e){var t=o.dragging,n=o.settings,r=n.minDistance,i=n.longPressDelay;t.minDistance=null!=r?r:e.isTouch?0:f.globalDefaults.eventDragMinDistance,t.delay=e.isTouch?null!=i?i:f.globalDefaults.longPressDelay:0},this.handleDragStart=function(e){e.isTouch&&o.dragging.delay&&e.subjectEl.classList.contains("fc-event")&&o.dragging.mirror.getMirrorEl().classList.add("fc-selected")},this.settings=t;var n=this.dragging=new p(e);n.touchScrollAllowed=!1,null!=t.itemSelector&&(n.pointer.selector=t.itemSelector),null!=t.appendTo&&(n.mirror.parentNode=t.appendTo),n.emitter.on("pointerdown",this.handlePointerDown),n.emitter.on("dragstart",this.handleDragStart),new b(n,t.eventData)}return e.prototype.destroy=function(){this.dragging.destroy()},e}(),R=function(r){function e(e){var t=r.call(this,e)||this;t.shouldIgnoreMove=!1,t.mirrorSelector="",t.currentMirrorEl=null,t.handlePointerDown=function(e){t.emitter.trigger("pointerdown",e),t.shouldIgnoreMove||t.emitter.trigger("dragstart",e)},t.handlePointerMove=function(e){t.shouldIgnoreMove||t.emitter.trigger("dragmove",e)},t.handlePointerUp=function(e){t.emitter.trigger("pointerup",e),t.shouldIgnoreMove||t.emitter.trigger("dragend",e)};var n=t.pointer=new o(e);return n.emitter.on("pointerdown",t.handlePointerDown),n.emitter.on("pointermove",t.handlePointerMove),n.emitter.on("pointerup",t.handlePointerUp),t}return a(e,r),e.prototype.destroy=function(){this.pointer.destroy()},e.prototype.setIgnoreMove=function(e){this.shouldIgnoreMove=e},e.prototype.setMirrorIsVisible=function(e){if(e)this.currentMirrorEl&&(this.currentMirrorEl.style.visibility="",this.currentMirrorEl=null);else{var t=this.mirrorSelector?document.querySelector(this.mirrorSelector):null;t&&((this.currentMirrorEl=t).style.visibility="hidden")}},e}(f.ElementDragging),I=function(){function e(e,t){var n=document;t=e===document||e instanceof Element?(n=e,t||{}):e||{};var r=this.dragging=new R(n);"string"==typeof t.itemSelector?r.pointer.selector=t.itemSelector:n===document&&(r.pointer.selector="[data-event]"),"string"==typeof t.mirrorSelector&&(r.mirrorSelector=t.mirrorSelector),new b(r,t.eventData)}return e.prototype.destroy=function(){this.dragging.destroy()},e}(),P=f.createPlugin({componentInteractions:[y,D,w,T],calendarInteractions:[M],elementDraggingImpl:p});e.Draggable=C,e.FeaturefulElementDragging=p,e.PointerDragging=o,e.ThirdPartyDraggable=I,e.default=P,Object.defineProperty(e,"__esModule",{value:!0})});