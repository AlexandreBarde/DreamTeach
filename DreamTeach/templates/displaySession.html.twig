{% extends 'base.html.twig' %}

{% block title %}Séance - DreamTeach{% endblock %}

{% block body %}

    <div class="container-fluid">
    {% for flash in app.flashes %}
        {{ flash }}
    {% endfor %}
    <div class="card">
        <div class="card-header" style="background-color: rgba(0,0,0,.00);">
            <h2>Description séance</h2>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-sm">

                    <div class="form-row">


                        <div class="form-group col" id="matiereEtudiee">
                            <p class="font-weight-bold"> Matière étudiée</p>
                            {{ session.subjectid.name }}
                        </div>
                        <div class="col">
                            <p class="font-weight-bold">Nom Session </p>
                            {{ session.name }}
                        </div>
                    </div>

                    <p class="font-weight-bold">Description séance</p>
                    {{ session.description }}
                </div>
            </div>
        </div>
    </div>
    <br/>
    <div class="card">
        <div class="card-header" style="background-color: rgba(0,0,0,.00);">
            <h2>Plannification</h2>
        </div>
        <div class="card-body">
            <div class="form-row">
                <div class="form-group col-md-4">
                    <p class="font-weight-bold">Date</p>
                    {{ session.date.format('Y-m-d') }}
                </div>
                <div class="form-group col-md-4">
                    <p class="font-weight-bold">Heure de début</p>
                    {{ session.startingtime.format('h:m') }}
                </div>
                <div class="form-group col-md-4">
                    <p class="font-weight-bold">Heure de fin</p>
                    {{ session.endingtime.format('h:m') }}
                </div>

            </div>

            <div class="form-row">
                <div class="form-group col-md-4">
                    <p class="font-weight-bold">Nombre max de participants</p>
                    {{ session.maxnbparticipant }}
                </div>

                {% if session.isvirtual %}
                <div class="form-group col-md-8">
                    <p class="font-weight-bold">Logiciel vocal</p>
                    {{ session.vocalSoftware }}
                </div>
                {% endif %}
            </div>

            {% if session.isvirtual==false %}
            <div class="form-row">

                <div class="form-group col-md-6">
                    <p class="font-weight-bold">Ville </p>
                    {{ session.city }}

                </div>
                <div class="form-group col-md-6">
                    <p class="font-weight-bold">Etablissement</p>
                    {{ session.place }}

                </div>

            </div>
            {% endif %}


        </div>

    </div>
    <br/>
    <div class="card">
        <div class="card-header" style="background-color: rgba(0,0,0,.00);">
            <h2>Commenter cette séance</h2>
        </div>
        <div class="card-body">
            {% for commentTmp in allSessionComments %}
                <div class="row">
                    <div class="col-sm">
                        <strong>
                            {{ commentTmp.idStudent.lastName }}
                            {{ commentTmp.idStudent.firstname }}:
                        </strong>
                        <br/>
                        {{ commentTmp.comment }}
                    </div>
                </div>
            {% endfor %}
            <br/>
            <div class="row">
                {{ form_start(formComment) }}
                <div class="form-row">
                    <div class="form-group col" id="matiereEtudiee">
                        <label for="commentaire">Ajouter un commentaire</label>
                        {{ form_widget(formComment.comment, {'id': 'commentaire'}) }}
                    </div>
                </div>
                <button id="envoyerCommentaire" type="submit">envoyer</button>
                {{ form_end(formComment) }}
            </div>
        </div>
    </div>
    {% block javascripts %}
        <script>
            $(document).ready(function () {
                var sessionDate = "{{ session.date|date('Y-m-d') }}";
                var sessionEndingTime = "{{ session.endingTime|date('H:i:s') }}";

                if("{{ 'now'|date('Y-m-d') }}" < sessionDate) {
                    $("#envoyerCommentaire").attr('disabled', true);
                    $("#commentaire").attr('disabled', true);
                } else {
                    if("{{ 'now'|date('H:i:s', "Europe/Paris") }}" < sessionEndingTime) {
                        $("#envoyerCommentaire").attr('disabled', true);
                        $("#commentaire").attr('disabled', true);
                    }
                }

            });
        </script>
    {% endblock %}
{% endblock %}